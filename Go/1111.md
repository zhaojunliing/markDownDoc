1. ä¸‹è½½é¢„è®­ç»ƒçš„æ¨¡å‹weights

   ```bash
   wget https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137
   ```

2. é…ç½®cfgæ–‡ä»¶

   åˆ›å»ºæ–‡ä»¶yolo-obj.cfg, æ˜¯ä»cfg/yolov4-custom.cfgç›´æ¥æ‹·è´æˆyolo-obj.cfgç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶çš„å†…å®¹

   ```bash
   cd darknet/cfg
   cp yolov4-custom.cfg yolo-obj.cfg
   vim yolo-obj.cfg
   ```

   - **batch = 64**
   - **subdivisions= 64**
   - **max_batches = ç¨®é¡æ•¸\*2000, ä½†ä¸å°‘æ–¼4000**e.g.,1é¡ -> **max_batches = 4000**2é¡ -> max_batches = 40003é¡ -> max_batches = 6000â€¦
   - **steps = max_batches * 0.8, max_batches * 0.9e.g.,**max_batches = 4000 -> **steps = 3200, 3600**
   - **width=416**è¨­å®šåœ–ç‰‡å¯¬åº¦(éœ€æ˜¯32çš„å€æ•¸)**height=416**è¨­å®šåœ–ç‰‡é«˜åº¦(éœ€æ˜¯32çš„å€æ•¸)

   ä¿®æ”¹[yolo]é‡Œé¢çš„classes=è‡ªå·±çš„ç±»åˆ«æ•°ç›®ï¼Œç„¶åè¿˜è¦ä¿®æ”¹[yolo]ä¸Šé¢çš„[convational]é‡Œçš„filterçš„æ•°ç›®ä¸º(class+5)*3

3. é…ç½®obj.namesæ–‡ä»¶

   é‡Œé¢å†™ç‰©ä½“åˆ†ç±»ï¼Œæ¯”æˆ‘è¿™æ¬¡å°±æ˜¯ä¸¤ä¸ªç±»åˆ«

   railway

   tuoguiqi

4. é…ç½®obj.dataæ–‡ä»¶

   å­˜æ”¾å„ç§æ–‡ä»¶è·¯å¾„

   ```bash
   classes=1
   train=/data/train.txt
   valid=/data/valid.txt
   names=data/obj.names
   backup=backup
   ```

   æˆ‘æ˜¯æŠŠæ‰€æœ‰å¾…è®­ç»ƒçš„æ”¾è¿›data/objæ–‡ä»¶å¤¹å†…ï¼Œç„¶åtrain.txté‡Œæ˜¯trainå›¾ç‰‡çš„è·¯å¾„ï¼Œvalidæ˜¯validå›¾ç‰‡çš„è·¯å¾„

5. å¼€å§‹è®­ç»ƒ

   ```bash
   darknet detector train data/obj.data cfg/yolo-obj.cfg yolov4.conv.137 -dont_show -map
   ```

æˆ‘ç”¨çš„æ˜¯darknetçš„dockerï¼Œç„¶åæœ€å…ˆä¸‹çš„æ˜¯daisukekobayashi/darknet:yolov4-gpu-cv-cc86-11.2.0-ubuntu18.04

ç„¶åæŠ¥äº†cuda status errorï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œä¸åŒçš„GPUå‹å·å±…ç„¶æœ‰ä¸åŒçš„ç®—åŠ›ï¼Œç„¶åæœåŠ¡å™¨çš„è¿™å°ç®—åŠ›æ˜¯6.1ï¼Œè¿™ä¸ªdockerçš„tagccè¡¨ç¤ºçš„æ˜¯ç®—åŠ›ï¼Œå°±åˆä¸‹è½½äº†å¦ä¸€ä¸ªdaisukekobayashi/darknet:yolov4-gpu-cv-cc61-11.2.0-ubuntu18.04

ç„¶åæ‰å¯ä»¥çš„

<aside> ğŸ’¡ æ ‡æ³¨çš„txtæ–‡ä»¶çš„æ ¼å¼æ˜¯ ç±»åˆ«number  ä¸­å¿ƒç‚¹åæ ‡ç›¸å¯¹ä½ç½®   å®½é•¿ç›¸å¯¹å€¼

æ³¨æ„ä¸€å®šè¦æ˜¯è¿™ä¸ªæ ¼å¼ï¼Œå‰é¢æ˜¯ç±»åˆ«numberï¼Œæˆ‘ä¹‹å‰å†™çš„ç±»åˆ«årailwayå’Œtuoguiqiï¼Œä½†æ˜¯è®­ç»ƒçš„ç»“æœæ ¹æœ¬ä»€ä¹ˆéƒ½è¯†åˆ«ä¸å‡ºæ¥ï¼Œæ”¹æˆnumberä¹‹åçœ‹ä»–çš„è®­ç»ƒè¿‡ç¨‹çš„è¾“å‡ºçœ‹èµ·æ¥æ‰æ­£å¸¸äº†ä¸€ç‚¹

</aside>

ç„¶ååœ¨ä½¿ç”¨dockerçš„æ—¶å€™é‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œä¸èƒ½åå°è¿è¡Œï¼Œç„¶åä½¿ç”¨äº†

```bash
docker run -d --runtime=nvidia -v $PWD:/data -w /data   daisukekobayashi/darknet:yolov4-gpu-cv-cc86-11.2.0-ubuntu18.04 tail -f /dev/null
```

è¿™ä¸ªå‘½ä»¤

æˆ‘çœ‹åˆè¯´åŠ -dæˆ–è€…-itï¼Œä½†æ˜¯æˆ‘ç”¨äº†å®Œå…¨æ²¡ç”¨

ç„¶ååœæ­¢ï¼Œåˆ é™¤ï¼Œéƒ½ç”¨docker container xxx id æ¥åšï¼Œå¯èƒ½åå°è¿è¡Œä¹Ÿèƒ½ç”¨è¿™ä¸ªï¼Œè°çŸ¥é“äº†